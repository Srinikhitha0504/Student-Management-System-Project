# student_management_sql.py
import sqlite3

# Connect to SQLite database (or create if it doesn't exist)
conn = sqlite3.connect('students.db')
cursor = conn.cursor()

# Create table if it doesn't exist
cursor.execute('''
CREATE TABLE IF NOT EXISTS students (
    id TEXT PRIMARY KEY,
    name TEXT NOT NULL,
    age INTEGER,
    course TEXT,
    marks REAL
)
''')
conn.commit()

def add_student():
    id = input("Enter Student ID: ")
    name = input("Enter Student Name: ")
    age = input("Enter Student Age: ")
    course = input("Enter Student Course: ")
    marks = input("Enter Student Marks: ")
    
    try:
        cursor.execute("INSERT INTO students (id, name, age, course, marks) VALUES (?, ?, ?, ?, ?)",
                       (id, name, age, course, marks))
        conn.commit()
        print("Student added successfully!\n")
    except sqlite3.IntegrityError:
        print("Error: Student ID already exists!\n")

def view_students():
    cursor.execute("SELECT * FROM students")
    students = cursor.fetchall()
    if students:
        print("ID\tName\tAge\tCourse\tMarks")
        for student in students:
            print(f"{student[0]}\t{student[1]}\t{student[2]}\t{student[3]}\t{student[4]}")
    else:
        print("No students found.\n")

def search_student():
    search_name = input("Enter student name to search: ")
    cursor.execute("SELECT * FROM students WHERE name LIKE ?", ('%' + search_name + '%',))
    students = cursor.fetchall()
    if students:
        print("ID\tName\tAge\tCourse\tMarks")
        for student in students:
            print(f"{student[0]}\t{student[1]}\t{student[2]}\t{student[3]}\t{student[4]}")
    else:
        print("No student found with that name.\n")

def update_student():
    student_id = input("Enter Student ID to update: ")
    cursor.execute("SELECT * FROM students WHERE id = ?", (student_id,))
    student = cursor.fetchone()
    if student:
        print("What do you want to update?")
        print("1. Name  2. Age  3. Course  4. Marks")
        choice = input("Enter choice (1-4): ")
        if choice == '1':
            new_value = input("Enter new Name: ")
            cursor.execute("UPDATE students SET name = ? WHERE id = ?", (new_value, student_id))
        elif choice == '2':
            new_value = input("Enter new Age: ")
            cursor.execute("UPDATE students SET age = ? WHERE id = ?", (new_value, student_id))
        elif choice == '3':
            new_value = input("Enter new Course: ")
            cursor.execute("UPDATE students SET course = ? WHERE id = ?", (new_value, student_id))
        elif choice == '4':
            new_value = input("Enter new Marks: ")
            cursor.execute("UPDATE students SET marks = ? WHERE id = ?", (new_value, student_id))
        else:
            print("Invalid choice!\n")
            return
        conn.commit()
        print("Student updated successfully!\n")
    else:
        print("Student ID not found!\n")

def delete_student():
    student_id = input("Enter Student ID to delete: ")
    cursor.execute("SELECT * FROM students WHERE id = ?", (student_id,))
    student = cursor.fetchone()
    if student:
        cursor.execute("DELETE FROM students WHERE id = ?", (student_id,))
        conn.commit()
        print("Student deleted successfully!\n")
    else:
        print("Student ID not found!\n")

# Main program
def main():
    while True:
        print("\n===== Student Management System =====")
        print("1. Add Student")
        print("2. View Students")
        print("3. Search Student")
        print("4. Update Student")
        print("5. Delete Student")
        print("6. Exit")
        choice = input("Enter your choice: ")

        if choice == '1':
            add_student()
        elif choice == '2':
            view_students()
        elif choice == '3':
            search_student()
        elif choice == '4':
            update_student()
        elif choice == '5':
            delete_student()
        elif choice == '6':
            print("Exiting program. Goodbye!")
            break
        else:
            print("Invalid choice. Please try again.\n")

if __name__ == "__main__":
    main()
    conn.close()
